local game = gg.getTargetInfo()
		or 
		{x64 = gg.alert('Is game?', '64 Bit', '', '32 Bit') == 1}
		local x64 = game.x64

local info = gg.getTargetInfo()
if info == nil then
  print("Can't retrieve information about the process")
else
  if not info.x64 then
    CheckBit = "32 Bit"
  else
    CheckBit = "64 Bit"
  end
end

		Game = gg["getTargetInfo"]().label
		Ver = gg["getTargetInfo"]().versionName
		pak = gg["getTargetInfo"]().packageName
		local cfg = loadfile(gg.EXT_CACHE_DIR .. '/' .. gg.getFile():match('[^/]+$'))
		cfg = cfg and cfg().version == version and cfg() or {-77, 47, false, false}
		credit = "@hnlsm"

    local GetKey = "https://t.me/lsModgaming"
    local API = "https://anotepad.com/notes/sp4n9yqx"
    local savedKeyFile = "saved_key.txt"
 
 
    function ReadSavedKey()
        local file = io.open(savedKeyFile, "r")
        if file then
            local savedKey = file:read("*a")
            file:close()
            return savedKey
        end
        return nil
    end
    
    
    function SaveKey(key)
        local file = io.open(savedKeyFile, "w")
        if file then
            file:write(key)
            file:close()
            gg.toast("Lưu Key Thành Công!")
        end
    end


    function DeleteKey()
        os.remove(savedKeyFile)
        gg.toast("Đã xoá key!")
    end
    
    
    local GetData = (gg.makeRequest(API).content)
    if not GetData then
        gg.alert("Lỗi khi lấy dữ liệu!")
        return
    end
    
   

    KeyOnline = string.match(GetData, "Key:%s*([%w%d]+)")
    ExpireDate = string.match(GetData, "ExpireDate:%s*(%d%d%d%d%-%d%d%-%d%d)")
    
    

    if KeyOnline == nil then
        gg.alert("Error fetching key! Kiểm tra lại format trong page note.")
        return
    end
    if ExpireDate == nil then
        gg.alert("Error fetching expire date! Kiểm tra lại format trong page note.")
        return
    end
    
    
    local CurrentDate = os.date("%Y-%m-%d")
    if CurrentDate > ExpireDate then
        gg.alert("Script đã hết hạn!\nExpire Date: " .. ExpireDate)
        os.exit()
    end
    
    
    local savedKey = ReadSavedKey()
    if savedKey and savedKey == KeyOnline then
        gg.toast("Tự động đăng nhập thành công!\nExpire Date: " .. ExpireDate)
    else
       
        local Pastek = gg.prompt({"Vui lòng nhập key để vào script"}, nil, {"text"})
        if Pastek == nil or Pastek[1] == "" then
            gg.alert("Key sai hoặc hết hạn!")
            return
        end
    
        if Pastek[1] ~= KeyOnline then
            local choice = gg.choice({"Copy Link", "OK"}, nil, "Sai mật khẩu!\nVui lòng vô nhóm để lấy key:\n"..GetKey)
            if choice == 1 then
                gg.copyText(GetKey)
                gg.alert("Link đã được sao chép vào clipboard!")
            end
            return
        else
            
            local saveChoice = gg.choice({"Lưu key", "Không Lưu"}, nil, "Đăng nhập thành công!\nBạn có muốn lưu key cho lần sau dùng không?")
            if saveChoice == 1 then
                SaveKey(Pastek[1])
            end
        end
    end
    

    if gg.choice({"Xoá key đã lưu", "Tiếp tục đăng nhập"}, nil, "Quản lý key đã lưu") == 1 then
        DeleteKey()
    end
    
    local SaveOFF = {}

local function hex2tbl(hex)
  local ret = {}
  hex:gsub('%S%S', function(ch)
    ret[#ret + 1] = ch
    return ''
  end)
  return ret
end

local function getValues(lib, address, length)
  local values = {}
  for i = 1, length do
    values[i] = {
      address = lib + address + i - 1,
      flags = gg.TYPE_BYTE
    }
  end
  return gg.getValues(values)
end

local function setValues(lib, address, values)
  local set = {}
  for i = 1, #values do
    set[i] = {
      address = lib + address + i - 1,
      value = values[i],
      flags = gg.TYPE_BYTE
    }
  end
  gg.setValues(set)
  gg.clearResults()
end

function SetValue(a, b, c)
  local set = {}
  local lib = gg.getRangesList(a)[1].start
  local Hex = hex2tbl(c)
  
  local V = {}
  for i = 1, #Hex do
    V[i] = tonumber(Hex[i], 16)
    if V[i] > 127 then
      V[i] = V[i] - 256
    end
  end
  
  if not SaveOFF[b] then
    local Z = {}
    for i = 1, #Hex do
      Z[i] = {
        address = lib + b + i - 1,
        flags = gg.TYPE_BYTE
      }
    end
    SaveOFF[b] = gg.getValues(Z)
  end
  
  local R = getValues(lib, b, #Hex)
  
  if R[1].value == V[1] and R[3].value == V[3] then
    gg.setValues(SaveOFF[b])
  else
    setValues(lib, b, V)
  end
end

function script()
m = gg.choice({
'Ghost Mode 64Bit (Đang lỗi)',
'Ghost Mode 32Bit',
'Exit script',
},1,os["date"]("📆 %A | %Y - %m - %d | %H:%M\
━━━━━━━━━━━━━━━━━━━━━━━━\
|| Game : " .. Game .. " ["..CheckBit.."]\
|| Package : " .. pak .. "\
|| Version : " .. Ver .. "\
|| Credit : "..credit.." [Telegarm]\
━━━━━━━━━━━━━━━━━━━━━━━━"))
if m == nil then gg.toast('HNhat') else
if m == 1 then ghost1() end
if m == 2 then ghost2() end
if m == 3 then thoat() end
if m == 4 then gg.setVisible(true) os.exit(print('HNhat')) end
end end
function ghost1()
gg.alert("Đã vào tiến trình Ghost, chỉ cần click vào GG để bật tắt")
local flag = true
while true do
if gg.isVisible(true) then
gg.clearResults()
if flag then
  flag = false
  SetValue("libil2cpp.so", 0x33bea7c, "00 00 80 D2 C0 03 5F D6")
   gg.clearResults()
    gg.setVisible(false)
    gg.toast("ON")
elseif flag == false then
  flag = true
  SetValue("libil2cpp.so", 0x33bea7c, "02 00 80 D2 C0 03 5F D6")
   gg.clearResults()
    gg.setVisible(false)
    gg.toast("OFF")
    end
end
gg.sleep(200)
end
gg.clearResults()
end
function ghost2()
gg.alert("Đã vào tiến trình Ghost, chỉ cần click vào GG để bật tắt")
local flag = true
while true do
if gg.isVisible(true) then
gg.clearResults()
if flag then
  flag = false
  SetValue("libil2cpp.so",0x1f4f1cc,"0000A0E31EFF2FE1")
   gg.clearResults()
    gg.setVisible(false)
    gg.toast("ON")
elseif flag == false then
  flag = true
  SetValue("libil2cpp.so",0x1f4f1cc,"F04F2DE91CB08DE2")
   gg.clearResults()
    gg.setVisible(false)
    gg.toast("OFF")
    end
end
gg.sleep(200)
end
 gg.clearResults()
end
function thoat()
  print("Goodbye see you later")
  print("                            ")
  print("                           ")
  print("Thank You For Using My Script ")
  print("Credit: Hoàng Nhật (Share hack free)                          ")
  print("Telegram: t.me/lsModgaming (Loadstring Mod)                     ")
  os.exit()
end
while true do if gg.isVisible() then gg.setVisible(false) script() end end
